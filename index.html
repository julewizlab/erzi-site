<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>erzi.site</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg-0: #010309;
    --bg-1: #040b16;
    --bg-2: #081221;
    --ink-soft: rgba(206, 226, 248, 0.68);
    --ink-muted: rgba(182, 204, 232, 0.4);
    --line-soft: rgba(160, 191, 227, 0.22);
    --line-strong: rgba(170, 206, 244, 0.46);
    --glass-bg: linear-gradient(
      140deg,
      rgba(9, 21, 38, 0.44) 0%,
      rgba(6, 14, 26, 0.24) 100%
    );
    --core-h: 210;
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 20px;
    --space-6: 24px;
    --space-7: 32px;
    --radius-pill: 999px;
    --radius-card: 14px;
    --hud-blur: 14px;
    --dur-fast: 180ms;
    --dur-base: 280ms;
    --dur-slow: 420ms;
    --ease-standard: cubic-bezier(0.22, 0.61, 0.36, 1);
    --ease-emphasis: cubic-bezier(0.2, 0.8, 0.2, 1);
    --ease-soft: cubic-bezier(0.33, 0, 0.18, 1);
  }
  
  body {
    position: relative;
    background: #02050b;
    min-height: 100vh;
    min-height: -webkit-fill-available;
    overflow: hidden;
    touch-action: none;
    overscroll-behavior: none;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
    font-family: "Manrope", "PingFang SC", "Noto Sans SC", sans-serif;
    color: var(--ink-soft);
  }

  body::before,
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
  }

  body::before {
    display: none;
  }

  body::after {
    display: none;
  }
  
  /* 移动端适配 */
  @media (max-width: 768px) {
    .cosmic-time { font-size: 10px !important; top: calc(var(--space-3) + env(safe-area-inset-top)) !important; }
    .mystery-counter { font-size: 9px !important; gap: var(--space-1) !important; bottom: calc(var(--space-3) + env(safe-area-inset-bottom)) !important; }
    .era-glyph { right: calc(var(--space-3) + env(safe-area-inset-right)) !important; top: calc(var(--space-3) + env(safe-area-inset-top)) !important; width: 22px !important; height: 22px !important; }
    .cursor { display: none !important; }
    .cursor-trail { display: none !important; }
  }

  @media (hover: none) and (pointer: coarse) {
    .cosmic-time,
    .mystery-counter { text-shadow: 0 0 10px rgba(120, 178, 236, 0.24); }
  }
  
  .cosmic-time {
    position: fixed;
    top: calc(var(--space-4) + env(safe-area-inset-top));
    left: 50%;
    transform: translateX(-50%);
    font-family: "IBM Plex Mono", "SF Mono", "JetBrains Mono", "Courier New", monospace;
    font-size: 11px;
    letter-spacing: 0.18em;
    color: var(--ink-muted);
    z-index: 1000;
    pointer-events: none;
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: 0;
    animation: cosmicBreathe 6s var(--ease-soft) infinite;
  }

  .cosmic-time .symbol {
    color: rgba(214, 236, 255, 0.76);
    text-shadow: 0 0 18px rgba(162, 205, 252, 0.34);
  }
  
  @keyframes cosmicBreathe {
    0%, 100% { opacity: 0.74; }
    50% { opacity: 0.98; }
  }
  
  .mystery-counter {
    position: fixed;
    bottom: calc(var(--space-4) + env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%);
    font-family: "IBM Plex Mono", "SF Mono", "JetBrains Mono", "Courier New", monospace;
    font-size: 11px;
    color: var(--ink-muted);
    z-index: 1000;
    pointer-events: none;
    display: flex;
    gap: var(--space-1);
    font-variant-numeric: tabular-nums;
    padding: 0;
  }

  .era-glyph {
    position: fixed;
    top: calc(var(--space-4) + env(safe-area-inset-top));
    right: calc(var(--space-4) + env(safe-area-inset-right));
    z-index: 1000;
    pointer-events: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 1px solid rgba(122, 164, 212, 0.34);
    box-shadow: 0 0 16px rgba(76, 124, 180, 0.24);
  }

  .era-glyph .g-core,
  .era-glyph .g-ring,
  .era-glyph .g-sat {
    position: absolute;
    inset: 0;
  }

  .era-glyph .g-core::before {
    content: '';
    position: absolute;
    left: 50%;
    top: 50%;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    background: rgba(168, 211, 255, 0.86);
    box-shadow: 0 0 10px rgba(120, 185, 245, 0.5);
  }

  .era-glyph .g-ring::before {
    content: '';
    position: absolute;
    inset: 4px;
    border-radius: 50%;
    border: 1px solid rgba(114, 160, 211, 0.26);
  }

  .era-glyph .g-sat::before {
    content: '';
    position: absolute;
    left: 50%;
    top: 50%;
    width: 2px;
    height: 2px;
    border-radius: 50%;
    background: rgba(171, 218, 255, 0.78);
    transform-origin: 0 -8px;
    transform: rotate(0deg) translateY(-8px);
    animation: glyphOrbit 7.6s linear infinite;
  }

  .era-glyph.shift {
    animation: glyphPulse 620ms var(--ease-emphasis);
  }

  @keyframes glyphOrbit {
    0% { transform: rotate(0deg) translateY(-8px); opacity: 0.9; }
    100% { transform: rotate(360deg) translateY(-8px); opacity: 0.9; }
  }

  @keyframes glyphSpin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  @keyframes glyphPulse {
    0% { transform: scale(1); opacity: 0.9; }
    50% { transform: scale(1.16); opacity: 1; }
    100% { transform: scale(1); opacity: 0.9; }
  }
  
  .rule-num {
    opacity: 0.28;
    color: rgba(188, 211, 238, 0.5);
    transition: transform var(--dur-base) var(--ease-standard), opacity var(--dur-base) var(--ease-standard), color var(--dur-base) var(--ease-standard), text-shadow var(--dur-base) var(--ease-standard);
  }
  
  .rule-num.completed {
    opacity: 0.95;
    color: rgba(233, 244, 255, 0.96);
    text-shadow: 0 0 12px rgba(170, 206, 247, 0.36);
  }
  
  .rule-num.flash {
    animation: numFlash 0.6s var(--ease-emphasis);
  }
  
  @keyframes numFlash {
    0% { transform: scale(1); opacity: 1; }
    30% { transform: scale(1.6); opacity: 1; text-shadow: 0 0 20px rgba(180,219,255,0.9); }
    100% { transform: scale(1); }
  }
  
  .cursor {
    position: fixed;
    width: 9px;
    height: 9px;
    background: rgba(213, 236, 255, 0.85);
    border: 1px solid rgba(188, 225, 255, 0.72);
    box-shadow: 0 0 20px rgba(141, 197, 255, 0.5);
    border-radius: 50%;
    pointer-events: none;
    z-index: 10000;
    mix-blend-mode: screen;
    transition: transform var(--dur-fast) var(--ease-standard);
  }
  
  .cursor-trail {
    position: fixed;
    width: 4px;
    height: 4px;
    background: rgba(170, 214, 255, 0.32);
    border-radius: 50%;
    pointer-events: none;
    z-index: 9999;
  }
  
  .breath {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 180px;
    height: 180px;
    pointer-events: none;
    transition: filter var(--dur-slow) var(--ease-soft), opacity var(--dur-slow) var(--ease-soft);
    z-index: 5;
  }
  
  .core {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    filter: blur(4px);
    animation: breathe 5.2s var(--ease-soft) infinite;
    box-shadow: 0 0 84px rgba(92, 142, 206, 0.24);
  }
  
  .ring {
    position: absolute;
    border-radius: 50%;
    border: 1px solid;
    filter: blur(0.6px);
    mix-blend-mode: screen;
  }
  
  @keyframes breathe {
    0%, 100% { transform: scale(1); opacity: 0.78; }
    50% { transform: scale(1.16); opacity: 0.36; }
  }
  
  .particle {
    position: fixed;
    border-radius: 50%;
    filter: blur(0.8px);
    pointer-events: none;
    transition: filter var(--dur-base) var(--ease-standard), box-shadow var(--dur-base) var(--ease-standard), opacity var(--dur-slow) var(--ease-soft);
    will-change: transform, opacity;
    z-index: 4;
  }
  
  .particle.awakened {
    filter: blur(0);
    box-shadow: 0 0 22px currentColor;
  }
  
  /* 增强动效 */
  .vortex {
    position: fixed;
    border-radius: 50%;
    border: 1.5px solid;
    animation: vortex-spin 2.8s var(--ease-emphasis) forwards;
    pointer-events: none;
    mix-blend-mode: screen;
  }
  
  @keyframes vortex-spin {
    0% { transform: scale(0) rotate(0deg); opacity: 1; }
    100% { transform: scale(4.4) rotate(900deg); opacity: 0; }
  }
  
  .pulse {
    position: fixed;
    border-radius: 50%;
    border: 1.5px solid;
    animation: pulse-expand 2.4s var(--ease-emphasis) forwards;
    pointer-events: none;
    mix-blend-mode: screen;
  }
  
  @keyframes pulse-expand {
    0% { transform: scale(0); opacity: 1; }
    100% { transform: scale(3.5); opacity: 0; }
  }
  
  .combo-burst {
    position: fixed;
    border-radius: 50%;
    border: 1.5px solid;
    animation: burst 1.2s var(--ease-emphasis) forwards;
    pointer-events: none;
    mix-blend-mode: screen;
  }
  
  @keyframes burst {
    0% { transform: scale(0); opacity: 1; }
    50% { transform: scale(2.7); opacity: 0.85; }
    100% { transform: scale(4.2); opacity: 0; }
  }
  
  .ripple {
    position: fixed;
    border-radius: 50%;
    border: 1px solid;
    animation: ripple-expand 2.7s var(--ease-emphasis) forwards;
    pointer-events: none;
    mix-blend-mode: screen;
    box-shadow: 0 0 40px rgba(164, 212, 255, 0.32);
  }
  
  @keyframes ripple-expand {
    0% { width: 0; height: 0; opacity: 0.72; }
    100% { width: 620px; height: 620px; opacity: 0; }
  }
  
  .hidden-shape {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    opacity: 0;
    transition: opacity var(--dur-slow) var(--ease-standard);
    z-index: 100;
  }
  
  .hidden-shape.visible {
    opacity: 1;
  }
  
  .hidden-shape svg {
    width: 300px;
    height: 300px;
    stroke: rgba(191, 220, 255, 0.62);
    fill: none;
    stroke-width: 1.3;
    filter: drop-shadow(0 0 20px rgba(159, 208, 255, 0.42));
  }
  
  body.slow-time .particle,
  body.slow-time .ring,
  body.slow-time .core {
    animation-duration: 12s !important;
    transition-duration: 1s !important;
  }
  
  .align-flash {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at center, rgba(169,216,255,0.2) 0%, transparent 70%);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--dur-base) var(--ease-standard);
  }
  
  .align-flash.active { opacity: 1; }
  
  .corner-indicator {
    position: fixed;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    opacity: 0;
    transition: opacity var(--dur-base) var(--ease-standard), transform var(--dur-base) var(--ease-standard);
    pointer-events: none;
    box-shadow: 0 0 28px rgba(149, 202, 255, 0.38);
  }
  
  .corner-indicator.active { opacity: 0.75; transform: scale(1.08); }
  .corner-indicator.tl { top: 20px; left: 20px; }
  .corner-indicator.tr { top: 20px; right: 20px; }
  .corner-indicator.bl { bottom: 60px; left: 20px; }
  .corner-indicator.br { bottom: 60px; right: 20px; }

  body.era-chaos .core {
    box-shadow: 0 0 120px rgba(178, 124, 250, 0.32);
  }

  body.era-chaos .era-glyph {
    border-color: rgba(196, 146, 255, 0.38);
    box-shadow: 0 0 18px rgba(154, 102, 222, 0.3);
  }

  body.era-chaos .era-glyph .g-ring::before {
    border-color: rgba(190, 144, 255, 0.42);
    border-style: dashed;
    animation: glyphSpin 2.4s linear infinite;
  }

  body.era-chaos .era-glyph .g-sat::before {
    animation-duration: 1.9s;
    transform-origin: 0 -9px;
  }

  body.era-eclipse {
    filter: saturate(0.84) brightness(0.9);
  }

  body.era-eclipse .breath {
    opacity: 0.74;
  }

  body.era-eclipse .cursor {
    opacity: 0.42;
  }

  body.era-eclipse .era-glyph {
    border-color: rgba(162, 193, 226, 0.36);
  }

  body.era-eclipse .era-glyph .g-ring::before {
    border-color: rgba(134, 165, 205, 0.38) transparent rgba(134, 165, 205, 0.38) transparent;
    transform: rotate(-26deg);
  }

  body.era-eclipse .era-glyph .g-sat::before {
    opacity: 0;
  }

  body.era-eclipse .era-glyph .g-core::before {
    transform: translate(-62%, -50%);
  }

  body.silent-shield .particle {
    opacity: 0.2 !important;
  }

  body.silent-shield .core {
    filter: blur(8px);
  }
  
  @keyframes edgeFade {
    0% { opacity: 1; }
    100% { opacity: 0; }
  }
  
  ::-webkit-scrollbar { display: none; }
</style>
</head>
<body>
  <div class="cosmic-time">
    <span class="symbol">Ω</span>
    <span class="number" id="cT">0000000000.00</span>
  </div>
  <div class="era-glyph" id="eraGlyph" aria-hidden="true">
    <span class="g-core"></span>
    <span class="g-ring"></span>
    <span class="g-sat"></span>
  </div>
  <div class="mystery-counter" id="mC"></div>
  <div class="cursor"></div>
  <div class="align-flash"></div>
  <div class="hidden-shape">
    <svg viewBox="0 0 100 100">
      <polygon points="50,10 90,90 10,90" />
    </svg>
  </div>
  <div class="corner-indicator tl"></div>
  <div class="corner-indicator tr"></div>
  <div class="corner-indicator bl"></div>
  <div class="corner-indicator br"></div>
  <div class="breath">
    <div class="core"></div>
  </div>
  
  <script>
    // Obfuscated variables
    const _0x0 = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o'];
    const _pH = [198, 206, 214, 224, 236, 246];
    const _tm = window.matchMedia('(hover: none) and (pointer: coarse)').matches;
    const _ht = _tm ? 2200 : 3000;
    const _it = _tm ? 2400 : 3000;
    let _h = 208, _tH = 208, _ts = 1, _rr = 2, _es = 1;
    const _gC = (h,s,l,a) => `hsla(${h},${s}%,${l}%,${a})`;

    function _v(p) {
      if (!_tm || !navigator.vibrate) return;
      navigator.vibrate(p);
    }
    
    // Game state (obfuscated)
    const _gs = {
      a: 0, b: Date.now(), c: [], d: [], e: 0, f: false,
      g: [], h: null, i: [], j: Date.now(), k: [], l: 0,
      m: [], n: 0, o: [], p: [], r: [], s: 0,
      q: JSON.parse(localStorage.getItem('_r') || '{}')
    };
    
    // Initialize counter
    function _uMC() {
      const c = document.getElementById('mC');
      c.innerHTML = _0x0.map((r, i) => {
        const d = _gs.q[r] ? 'completed' : '';
        return `<span class="rule-num ${d}" data-i="${i}">${i}</span>`;
      }).join('');
    }
    _uMC();

    const _eg = document.getElementById('eraGlyph');
    const _esm = [
      { c: 'era-stable', d: 46000, s: 1, b: 208 },
      { c: 'era-chaos', d: 32000, s: 1.2, b: 226 },
      { c: 'era-eclipse', d: 26000, s: 0.74, b: 200 }
    ];
    let _ei = 0, _et = Date.now();

    function _fG() {
      if (!_eg) return;
      _eg.classList.remove('shift');
      void _eg.offsetWidth;
      _eg.classList.add('shift');
    }

    function _sE(i, n = true) {
      _ei = i;
      _et = Date.now();
      const e = _esm[_ei];
      document.body.classList.remove('era-stable', 'era-chaos', 'era-eclipse');
      document.body.classList.add(e.c);
      _es = e.s;
      _tH = e.b;
      if (n) {
        _fG();
        _v([8, 12, 8]);
      }
    }

    function _uE() {
      const e = _esm[_ei];
      if (Date.now() - _et > e.d) _sE((_ei + 1) % _esm.length);
      requestAnimationFrame(_uE);
    }

    function _cSh() {
      const n = Date.now();
      _gs.r.push(n);
      _gs.r = _gs.r.filter(t => n - t < 2200);
      if (_gs.s && n < _gs.s) return true;
      const _tl = _tm ? 14 : 10;
      if (_gs.r.length > _tl) {
        _gs.s = n + (_tm ? 5200 : 6200);
        document.body.classList.add('silent-shield');
        _v([18, 24, 18]);
        setTimeout(() => {
          if (Date.now() >= _gs.s) document.body.classList.remove('silent-shield');
        }, _tm ? 5400 : 6400);
        return true;
      }
      return false;
    }
    
    // Complete rule with flash
    function _cR(id) {
      let _nu = false;
      if (!_gs.q[id]) {
        _gs.q[id] = true;
        localStorage.setItem('_r', JSON.stringify(_gs.q));
        _uMC();
        _nu = true;
      }
      // Flash the number
      const idx = _0x0.indexOf(id);
      if (idx >= 0) {
        const el = document.querySelector(`.rule-num[data-i="${idx}"]`);
        if (el) {
          el.classList.remove('flash');
          void el.offsetWidth;
          el.classList.add('flash');
        }
      }
      if (_nu) _v(10);
    }
    
    // Color system
    function _uC() {
      const e = _esm[_ei];
      if (Math.random() < (_ei === 1 ? 0.005 : 0.0012)) {
        _tH = _pH[Math.floor(Math.random() * _pH.length)] + (Math.random() * 10 - 5);
      }
      const d = _tH - _h;
      _h += d * (0.0012 + (_ei === 1 ? 0.0012 : 0)) * _ts;
      if (_h < 0) _h += 360;
      if (_h >= 360) _h -= 360;
      document.documentElement.style.setProperty('--core-h', _h.toFixed(1));
      document.querySelector('.core').style.background = 
        `radial-gradient(circle,${_gC(_h,66,62,0.42)} 0%,${_gC(_h,58,44,0.2)} 45%,${_gC(e.b,52,36,0.08)} 66%,transparent 78%)`;
      requestAnimationFrame(_uC);
    }
    
    // Rings
    const _rs = [];
    function _cRs() {
      const b = document.querySelector('.breath');
      for (let i = 0; i < 7; i++) {
        const r = document.createElement('div');
        r.className = 'ring';
        const s = 180 + i * 52;
        r.style.cssText = `width:${s}px;height:${s}px;left:${i*-26}px;top:${i*-26}px;animation:breathe ${4.6+Math.random()*2.4}s var(--ease-soft) infinite ${i*0.35}s`;
        b.appendChild(r);
        _rs.push({ el: r, bs: s, ho: i * 9, p: Math.random() * Math.PI * 2 });
      }
    }
    
    function _uRs() {
      const t = Date.now() / 1000 * _ts * _es;
      _rs.forEach((r, i) => {
        const w = Math.sin(t * 0.44 + r.p) * 4.5;
        const sc = 1 + Math.sin(t * 0.26 + i) * 0.04;
        r.el.style.width = (r.bs + w) + 'px';
        r.el.style.height = (r.bs + w * 0.7) + 'px';
        r.el.style.transform = `rotate(${t * _rr + i * 12}deg) scale(${sc})`;
        const sa = _ei === 1 ? 58 : (_ei === 2 ? 42 : 50);
        const aa = (_ei === 2 ? 0.1 : 0.17) - i * 0.012;
        r.el.style.borderColor = _gC((_h + r.ho + t * 1.4) % 360, sa, 60, Math.max(0.02, aa));
      });
      requestAnimationFrame(_uRs);
    }
    
    // Particles
    const _ps = [];
    function _cPs() {
      const _pc = _tm ? 24 : 44;
      for (let i = 0; i < _pc; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        const s = 1.6 + Math.random() * 3.6;
        p.style.cssText = `width:${s}px;height:${s}px`;
        document.body.appendChild(p);
        _ps.push({
          el: p, x: Math.random() * window.innerWidth, y: Math.random() * window.innerHeight,
          vx: (Math.random() - 0.5) * 0.5, vy: -0.3 - Math.random() * 0.5,
          p: Math.random() * Math.PI * 2, ho: Math.random() * 60, s,
          cc: 0, ia: false, ap: null, wm: false
        });
      }
    }
    
    let _idl = 0; // idle counter
    function _uPs() {
      const t = Date.now() / 1000 * _ts * _es;
      const cx = window.innerWidth / 2, cy = window.innerHeight / 2;
      
      // Check idle (no interaction for 3 seconds)
      const now = Date.now();
      if (now - _gs.b > _it) {
        _idl++;
      } else {
        _idl = 0;
      }
      
      _ps.forEach(p => {
        // Organic motion
        const wx = Math.sin(t + p.p) * 0.8;
        const wy = Math.cos(t * 0.7 + p.p) * 0.3;
        p.vx += wx * 0.01;
        p.vy += wy * 0.01;
        
        // If idle, enter random wandering mode
        if (_idl > 0 && !p.ia) {
          p.wm = true;
          // Random direction changes
          if (Math.random() < 0.02) {
            p.vx += (Math.random() - 0.5) * 0.5;
            p.vy += (Math.random() - 0.5) * 0.5;
          }
        } else {
          p.wm = false;
          // Center attraction
          const dx = cx - p.x, dy = cy - p.y;
          const d = Math.sqrt(dx * dx + dy * dy);
          if (d > 100) {
            p.vx += dx / d * 0.005;
            p.vy += dy / d * 0.005;
          }
        }
        
        // Awakened follow cursor
        if (p.ia) {
          const ax = _mX - p.x, ay = _mY - p.y;
          const ad = Math.sqrt(ax * ax + ay * ay);
          if (ad > 0.001) {
            p.vx += ax / ad * 0.15;
            p.vy += ay / ad * 0.15;
          }
        }
        
        // Attraction point
        if (p.ap) {
          const ax = p.ap.x - p.x, ay = p.ap.y - p.y;
          const ad = Math.sqrt(ax * ax + ay * ay);
          if (ad > 20.001) {
            p.vx += ax / ad * 0.1;
            p.vy += ay / ad * 0.1;
          } else {
            p.ap = null;
          }
        }
        
        // Damping
        p.vx *= 0.99;
        p.vy *= 0.99;
        
        // Speed limit in wander mode
        if (p.wm) {
          const spd = Math.sqrt(p.vx * p.vx + p.vy * p.vy);
          if (spd > 1) {
            p.vx *= 0.95;
            p.vy *= 0.95;
          }
        }
        
        p.x += p.vx * _ts;
        p.y += p.vy * _ts;
        
        // Bounds
        if (p.x < -50) p.x = window.innerWidth + 50;
        if (p.x > window.innerWidth + 50) p.x = -50;
        if (p.y < -50) { p.y = window.innerHeight + 50; p.x = Math.random() * window.innerWidth; }
        
        p.el.style.left = p.x + 'px';
        p.el.style.top = p.y + 'px';
        
        const h = (_h + p.ho + t * (_ei === 1 ? 8 : 4.8)) % 360;
        const sat = _ei === 1 ? 72 : (_ei === 2 ? 48 : 62);
        const lit = _ei === 2 ? 66 : 61;
        const alp = (_ei === 2 ? 0.28 : 0.42) * _sb;
        p.el.style.background = _gC(h, sat, p.ia ? lit + 11 : lit, p.ia ? 0.86 : Math.min(0.86, alp));
        p.el.style.color = _gC(h, sat, 74, 1);
      });
      
      // Check silence
      _cSl();
      
      requestAnimationFrame(_uPs);
    }
    
    // Cursor
    const _cr = document.querySelector('.cursor');
    const _tr = [];
    let _mX = window.innerWidth / 2, _mY = window.innerHeight / 2;
    
    function _iCr() {
      for (let i = 0; i < 12; i++) {
        const t = document.createElement('div');
        t.className = 'cursor-trail';
        t.style.opacity = (1 - i / 12) * 0.24;
        document.body.appendChild(t);
        _tr.push({ el: t, x: _mX, y: _mY });
      }
    }
    
    function _hM(x, y, s = false) {
      if (s) {
        _mX += (x - _mX) * 0.38;
        _mY += (y - _mY) * 0.38;
      } else {
        _mX = x;
        _mY = y;
      }
      _gs.g.push({ x, y, t: Date.now() });
      const n = Date.now();
      _gs.g = _gs.g.filter(p => n - p.t < 1000);
      _cCr();
      _cEW(x, y);
      _cDi(x, y);
      _cCG(x, y);
      _cSC(x, y);
    }
    
    let _tp = null, _tf = 0;
    document.addEventListener('mousemove', e => _hM(e.clientX, e.clientY));
    document.addEventListener('touchmove', e => {
      e.preventDefault();
      const t = e.touches[0];
      _tp = { x: t.clientX, y: t.clientY };
      if (_tf) return;
      _tf = requestAnimationFrame(() => {
        _tf = 0;
        if (_tp) _hM(_tp.x, _tp.y, true);
      });
    }, { passive: false });
    
    function _uCr() {
      _cr.style.left = _mX + 'px';
      _cr.style.top = _mY + 'px';
      _tr.forEach((t, i) => {
        const p = i === 0 ? { x: _mX, y: _mY } : _tr[i - 1];
        t.x += (p.x - t.x) * 0.15;
        t.y += (p.y - t.y) * 0.15;
        t.el.style.left = t.x + 'px';
        t.el.style.top = t.y + 'px';
      });
      requestAnimationFrame(_uCr);
    }
    
    // === RULES ===
    
    // R1: Combo
    function _cCb(x, y) {
      const n = Date.now();
      const d = n - _gs.a;
      if (d < 300) { _gs.a = n; _gs.b = n; }
      else { _gs.a = n; _gs.b = n; _gs.c = [1]; return; }
      if (++_gs.c[0] >= 5) { _tCb(x, y); _gs.c = [1]; }
    }
    
    function _tCb(x, y) {
      _cR(_0x0[0]);
      _rr = 8;
      setTimeout(() => _rr = 2, 2500);
      for (let i = 0; i < 3; i++) {
        setTimeout(() => {
          const b = document.createElement('div');
          b.className = 'combo-burst';
          b.style.cssText = `border-color:${_gC((_h+i*18)%360,66,62,0.62)};left:${x-150}px;top:${y-150}px;animation-delay:${i*0.12}s`;
          document.body.appendChild(b);
          setTimeout(() => b.remove(), 1200);
        }, i * 120);
      }
    }
    
    // R2: Rhythm (stable)
    function _cRh() {
      const n = Date.now(), d = n - _gs.j;
      _gs.j = n;
      if (d > 200 && d < 600) {
        _gs.i.push(d);
        if (_gs.i.length > 5) _gs.i.shift();
        if (_gs.i.length >= 3) {
          const l3 = _gs.i.slice(-3), av = l3.reduce((a,b) => a+b) / 3;
          if (l3.every(g => Math.abs(g - av) < av * 0.4)) {
            _tRh();
            _gs.i = [];
          }
        }
      } else if (d > 1000) {
        _gs.i = [];
      }
    }
    
    function _tRh() {
      _cR(_0x0[1]);
      _ps.forEach(p => p.ap = { x: window.innerWidth / 2, y: window.innerHeight / 2 });
    }
    
    // R3: Circle
    function _cCr() {
      if (_gs.g.length < 20) return;
      const ps = _gs.g, f = ps[0], l = ps[ps.length - 1];
      if (Math.sqrt((f.x-l.x)**2 + (f.y-l.y)**2) < 50) {
        const cx = window.innerWidth / 2, cy = window.innerHeight / 2;
        let qs = new Set();
        ps.forEach(p => {
          if (p.x < cx && p.y < cy) qs.add('tl');
          if (p.x > cx && p.y < cy) qs.add('tr');
          if (p.x < cx && p.y > cy) qs.add('bl');
          if (p.x > cx && p.y > cy) qs.add('br');
        });
        if (qs.size === 4) {
          _tVx((f.x+l.x)/2, (f.y+l.y)/2);
          _gs.g = [];
        }
      }
    }
    
    function _tVx(x, y) {
      _cR(_0x0[2]);
      for (let i = 0; i < 4; i++) {
        setTimeout(() => {
          const v = document.createElement('div');
          v.className = 'vortex';
          v.style.cssText = `border-color:${_gC((_h+i*20)%360,62,60,0.56)};left:${x-150}px;top:${y-150}px;animation-delay:${i*0.16}s`;
          document.body.appendChild(v);
          setTimeout(() => v.remove(), 2800);
        }, i * 160);
      }
    }
    
    // R4: Corners
    function _cCo(x, y) {
      const m = 80, w = window.innerWidth, h = window.innerHeight;
      let c = null;
      if (x < m && y < m) c = 'tl';
      else if (x > w - m && y < m) c = 'tr';
      else if (x < m && y > h - m) c = 'bl';
      else if (x > w - m && y > h - m) c = 'br';
      
      document.querySelectorAll('.corner-indicator').forEach(el => {
        el.classList.remove('active');
        el.style.background = _gC((_h+16)%360, 56, 64);
      });
      
      if (c) {
        document.querySelector(`.corner-indicator.${c}`).classList.add('active');
        if (_gs.d.length === 0 || _gs.d[_gs.d.length-1] !== c) {
          _gs.d.push(c);
          if (_gs.d.length >= 4) {
            const l4 = _gs.d.slice(-4);
            if (new Set(l4).size === 4) {
              _tHS();
              _gs.d = [];
            }
          }
        }
      }
    }
    
    function _tHS() {
      _cR(_0x0[3]);
      const s = document.querySelector('.hidden-shape');
      s.classList.add('visible');
      setTimeout(() => s.classList.remove('visible'), 2500);
    }
    
    // R5: Long press
    function _sLP() { _gs.e = Date.now(); _gs.f = true; }
    function _eLP() {
      if (_gs.f && Date.now() - _gs.e > _ht) _tST();
      _gs.f = false;
    }
    
    function _tST() {
      _cR(_0x0[4]);
      document.body.classList.add('slow-time');
      _ts = 0.3;
      setTimeout(() => { document.body.classList.remove('slow-time'); _ts = 1; }, 5500);
    }
    
    // R6: Awaken particle
    function _cPC(x, y) {
      for (let p of _ps) {
        if (Math.sqrt((p.x-x)**2 + (p.y-y)**2) < 30) {
          if (++p.cc >= 3 && !p.ia) {
            p.ia = true;
            p.el.classList.add('awakened');
            _cR(_0x0[5]);
            setTimeout(() => { p.ia = false; p.el.classList.remove('awakened'); p.cc = 0; }, 10000);
          }
          break;
        }
      }
    }
    
    // R7: Silence
    let _sb = 0.72, _sc = false;
    function _cSl() {
      const n = Date.now(), d = n - _gs.b;
      if (d > 5000) {
        _sb = Math.min(1.1, 0.72 + (d - 5000) / 18000);
        if (_sb >= 1.06 && !_sc) { _cR(_0x0[6]); _sc = true; }
      } else {
        _sb = _ei === 2 ? 0.56 : 0.72;
        _sc = false;
      }
    }
    
    // R8: Edge walk
    function _cEW(x, y) {
      const m = 30;
      const oe = (x < m) || (x > window.innerWidth - m) || (y < m) || (y > window.innerHeight - m);
      if (oe) {
        _gs.k.push({ x, y, t: Date.now() });
        const n = Date.now();
        _gs.k = _gs.k.filter(p => n - p.t < 2000);
        if (_gs.k.length > 30) { _tEG(); _gs.k = []; }
      } else { _gs.k = []; }
    }
    
    function _tEG() {
      _cR(_0x0[7]);
      const g = document.createElement('div');
      g.style.cssText = `position:fixed;inset:0;box-shadow:inset 0 0 140px ${_gC(_h,54,54,0.34)};pointer-events:none;animation:edgeFade 2.5s var(--ease-emphasis) forwards`;
      document.body.appendChild(g);
      setTimeout(() => g.remove(), 2500);
    }
    
    // R9: Diagonal
    function _cDi(x, y) {
      const m = 60, w = window.innerWidth, h = window.innerHeight;
      const cs = { tl: {x:0,y:0}, tr: {x:w,y:0}, bl: {x:0,y:h}, br: {x:w,y:h} };
      Object.entries(cs).forEach(([n, p]) => {
        if (Math.abs(x - p.x) < m && Math.abs(y - p.y) < m) {
          if (!_gs.l) _gs.l = [];
          _gs.l.push({ c: n, t: Date.now() });
          const now = Date.now();
          _gs.l = _gs.l.filter(p => now - p.t < 3000);
          if (_gs.l.length >= 2) {
            const f = _gs.l[0].c, lt = _gs.l[_gs.l.length-1].c;
            if ((f==='tl'&&lt==='br')||(f==='br'&&lt==='tl')||(f==='tr'&&lt==='bl')||(f==='bl'&&lt==='tr')) {
              _tDP();
              _gs.l = [];
            }
          }
        }
      });
    }
    
    function _tDP() {
      _cR(_0x0[8]);
      const o = _rr;
      _rr = 0;
      setTimeout(() => _rr = o, 3500);
    }
    
    // R10: Center gaze
    function _cCG(x, y) {
      const cx = window.innerWidth / 2, cy = window.innerHeight / 2;
      const d = Math.sqrt((x-cx)**2 + (y-cy)**2);
      if (d < 50) {
        if (!_gs.m) _gs.m = Date.now();
        else if (Date.now() - _gs.m > 2000) { _tPV(); _gs.m = 0; }
      } else { _gs.m = 0; }
    }
    
    function _tPV() {
      _cR(_0x0[9]);
      _ps.forEach(p => p.el.style.opacity = '0');
      setTimeout(() => _ps.forEach(p => p.el.style.opacity = '1'), 1000);
    }
    
    // R11: Breath sync
    function _cBS() {
      const n = Date.now();
      _gs.n = n;
      _gs.o.push(n);
      _gs.o = _gs.o.filter(t => n - t < 20000);
      if (_gs.o.length >= 3) {
        const l3 = _gs.o.slice(-3), gs = [l3[1]-l3[0], l3[2]-l3[1]];
        if (gs.every(g => g > 3000 && g < 5000) && Math.abs(gs[0]-gs[1]) < 1500) {
          _tBS();
          _gs.o = [];
        }
      }
    }
    
    function _tBS() {
      _cR(_0x0[10]);
      _ps.forEach(p => p.ho = 0);
      setTimeout(() => _ps.forEach(p => p.ho = Math.random() * 60), 3500);
    }
    
    // R12: S curve
    function _cSC(x, y) {
      _gs.p.push({ x, y, t: Date.now() });
      const n = Date.now();
      _gs.p = _gs.p.filter(p => n - p.t < 2000);
      if (_gs.p.length > 30) {
        const ys = _gs.p.map(p => p.y);
        let ps = 0;
        for (let i = 1; i < ys.length - 1; i++) {
          if ((ys[i] > ys[i-1] && ys[i] > ys[i+1]) || (ys[i] < ys[i-1] && ys[i] < ys[i+1])) ps++;
        }
        if (ps >= 4) { _tSW(); _gs.p = []; }
      }
    }
    
    function _tSW() {
      _cR(_0x0[11]);
      _rs.forEach((r, i) => {
        r.el.style.transition = 'transform var(--dur-slow) var(--ease-emphasis)';
        r.el.style.transform = `rotate(${Date.now()/1000*_rr}deg) skewX(${(i%2===0?1:-1)*15}deg)`;
        setTimeout(() => r.el.style.transition = '', 600);
      });
    }
    
    // R13: Triple pause
    function _cTP() {
      const n = Date.now(), d = n - _gs.b;
      if (d > 500 && d < 2000) {
        if (!_gs.h) _gs.h = [];
        _gs.h.push({ t: n, g: d });
        _gs.h = _gs.h.slice(-3);
        if (_gs.h.length === 3) {
          const gs = _gs.h.map(c => c.g), av = gs.reduce((a,b) => a+b) / 3;
          if (gs.every(g => Math.abs(g - av) < av * 0.3)) {
            _tTP();
            _gs.h = [];
          }
        }
      } else { _gs.h = []; }
    }
    
    function _tTP() {
      _cR(_0x0[12]);
      const c = document.querySelector('.core');
      let ct = 0;
      const iv = setInterval(() => {
        c.style.transform = `scale(${1 + (ct % 2) * 0.4})`;
        if (++ct >= 6) { clearInterval(iv); c.style.transform = ''; }
      }, 350);
    }
    
    // R14: Cosmic (100s)
    const _CE = new Date('2022-11-30T00:00:00Z').getTime();
    let _lr = 0;
    function _uCT() {
      const n = Date.now(), cs = (n - _CE) / 1000, fm = cs.toFixed(2);
      const pts = fm.split('.'), ip = pts[0].padStart(10, '0');
      document.getElementById('cT').textContent = ip + '.' + pts[1];
      const is = Math.floor(cs);
      if (is % 100 === 0 && is !== _lr) { _lr = is; _tCR(); }
      requestAnimationFrame(_uCT);
    }
    
    function _tCR() {
      _cR(_0x0[13]);
      const te = document.querySelector('.cosmic-time');
      te.style.color = 'rgba(227,241,255,0.92)';
      te.style.textShadow = '0 0 26px rgba(175,217,255,0.52)';
      _ps.forEach((p, i) => {
        setTimeout(() => {
          p.el.style.transform = 'scale(2.15)';
          setTimeout(() => p.el.style.transform = '', 270);
        }, i * 46);
      });
      setTimeout(() => {
        te.style.color = '';
        te.style.textShadow = '';
      }, 3500);
    }
    
    // R15: Random pulse
    function _rP() {
      const pr = _ei === 1 ? 0.0012 : 0.00035;
      if (Math.random() < pr) {
        _cR(_0x0[14]);
        const p = document.createElement('div');
        p.className = 'pulse';
        p.style.cssText = `left:${Math.random()*window.innerWidth}px;top:${Math.random()*window.innerHeight}px;border-color:${_gC((_h+Math.random()*40-20)%360,60,58,0.44)}`;
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 2400);
      }
      requestAnimationFrame(_rP);
    }
    
    // Click handler
    function _hC(x, y) {
      _gs.b = Date.now();
      if (_cSh()) return;
      const r = document.createElement('div');
      r.className = 'ripple';
      r.style.cssText = `border-color:${_gC((_h+Math.random()*24-12)%360,66,64,0.58)};left:${x-300}px;top:${y-300}px`;
      document.body.appendChild(r);
      setTimeout(() => r.remove(), 2700);
      _cCb(x, y);
      _cRh();
      _cCo(x, y);
      _cPC(x, y);
      _cBS();
      _cTP();
    }
    
    document.addEventListener('mousedown', e => { _sLP(); _hC(e.clientX, e.clientY); });
    document.addEventListener('mouseup', _eLP);
    document.addEventListener('touchstart', e => {
      e.preventDefault();
      const t = e.touches[0];
      _hM(t.clientX, t.clientY, true);
      _sLP();
      _v(5);
      _hC(t.clientX, t.clientY);
    }, { passive: false });
    document.addEventListener('touchend', _eLP);
    
    // Alignment
    let _la = 0;
    function _cA() {
      const t = Date.now() / 1000;
      const ap = _ei === 1 ? 0.0011 : 0.00045;
      if (t - _la > 24 && Math.random() < ap) {
        _la = t;
        const f = document.querySelector('.align-flash');
        f.classList.add('active');
        _rs.forEach(r => {
          r.el.style.animation = 'none';
          void r.el.offsetHeight;
          r.el.style.animation = 'breathe 5.2s var(--ease-soft) infinite';
        });
        setTimeout(() => f.classList.remove('active'), 760);
      }
      requestAnimationFrame(_cA);
    }
    
    // Initialize
    _sE(0, false);
    _cRs();
    _cPs();
    _iCr();
    _uC();
    _uRs();
    _uPs();
    _uCr();
    _rP();
    _cA();
    _uCT();
    _uE();
  </script>
</body>
</html>
